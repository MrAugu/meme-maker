!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.CanvasConstructor=e():t.CanvasConstructor=e()}(window,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){t.exports={...r(1),Canvas:r(2)}},function(t,e){e.invert=(t=>t.save().setGlobalCompositeOperation("difference").setColor("white").addRect(0,0,t.width,t.height).restore()),e.greyscale=e.grayscale=(t=>t.save().setGlobalCompositeOperation("hsl-saturation").setColor("white").addRect(0,0,t.width,t.height).restore()),e.invertGreyscale=e.invertGrayscale=(t=>t.save().setGlobalCompositeOperation("hsl-saturation").setColor("white").addRect(0,0,t.width,t.height).setGlobalCompositeOperation("difference").setColor("white").addRect(0,0,t.width,t.height).restore()),e.sepia=(t=>{const e=t.getImageData(),{data:r}=e;for(let t=0;t<r.length;t+=4){const e=r[t],n=r[t+1],i=r[t+2];r[t]=.393*e+.769*n+.189*i,r[t+1]=.349*e+.686*n+.168*i,r[t+2]=.272*e+.534*n+.131*i}return t.putImageData(e,0,0)}),e.silhouette=(t=>{const e=t.getImageData(),{data:r}=e;for(let t=0;t<r.length;t+=4)r[t]=r[t+1]=r[t+2]=0;return t.putImageData(e,0,0)}),e.threshold=((t,e)=>{const r=t.getImageData(),{data:n}=r;for(let t=0;t<n.length;t+=4)n[t]=n[t+1]=n[t+2]=.2126*n[t]+.7152*n[t+1]+.0722*n[t+2]>=e?255:0;return t.putImageData(r,0,0)}),e.invertedThreshold=((t,e)=>{const r=t.getImageData(),{data:n}=r;for(let t=0;t<n.length;t+=4)n[t]=n[t+1]=n[t+2]=.2126*n[t]+.7152*n[t+1]+.0722*n[t+2]>=e?0:255;return t.putImageData(r,0,0)}),e.brightness=((t,e)=>t.save().setGlobalAlpha(e/100).setColor("white").addRect(0,0,t.width,t.height).restore()),e.darkness=e.myOldFriend=((t,e)=>t.save().setGlobalAlpha(e/100).setColor("black").addRect(0,0,t.width,t.height).restore()),e.sharpen=((t,[r,n])=>e.convolute(t,[0,r,0,r,n,r,0,r,0])),e.blur=((t,r)=>e.convolute(t,new Array(9).fill(1/r))),e.convolute=((t,e)=>{const r=t.getImageData(),{data:n}=r,{width:i,height:s}=t;for(let t=0;t<s;t++)for(let r=0;r<i;r++){const o=4*(t*i+r);let a=0,h=0,c=0;for(let o=0;o<3;o++)for(let u=0;u<3;u++){const l=t+o-1,d=r+u-1;if(l<0||l>=s||d<0||d>=i)continue;const f=4*(l*i+d),x=e[3*o+u];a+=n[f]*x,h+=n[f+1]*x,c+=n[f+2]*x}n[o]=a,n[o+1]=h,n[o+2]=c}return t.putImageData(r,0,0)})},function(t,e,r){const n="undefined"!=typeof window,i=(()=>{if(n)return"undefined"!=typeof HTMLCanvasElement?HTMLCanvasElement:null;try{return r(3)}catch(t){return r(4)}})(),s=n?()=>null:"function"==typeof i.createCanvas?i.createCanvas:(...t)=>new i(...t);class Canvas{constructor(...t){this.canvas=s(...t),this.context=this.canvas?this.canvas.getContext("2d"):null}get width(){return this.canvas.width}set width(t){this.canvas.width=t}get height(){return this.canvas.height}set height(t){this.canvas.height=t}changeCanvasSize(t,e){return"number"==typeof t&&!1===Number.isNaN(t)&&(this.width=t),"number"==typeof e&&!1===Number.isNaN(e)&&(this.height=e),this}changeCanvasWidth(t){return this.changeCanvasSize(t,void 0)}changeCanvasHeigth(t){return this.changeCanvasSize(void 0,t)}save(){return this.context.save(),this}restore(){return this.context.restore(),this}rotate(...t){return this.context.rotate(...t),this}scale(...t){return this.context.scale(...t),this}translate(...t){return this.context.translate(...t),this}clip(...t){return this.context.clip(...t),this}setTransform(...t){return this.context.setTransform(...t),this}resetTransformation(){return this.setTransform(1,0,0,1,0,0)}getImageData(t=0,e=0,r=this.width,n=this.height,i){if("function"==typeof t&&(i=t,t=0),i){if("function"!=typeof i)throw new TypeError("Callback must be a function");return i.call(this,this.context.getImageData(t,e,r,n),this),this}return this.context.getImageData(t,e,r,n)}putImageData(...t){return this.context.putImageData(...t),this}fill(...t){return this.context.fill(...t),this}addText(...t){return this.context.fillText(...t),this}addResponsiveText(t,e,r,n){const[,i="",s,o]=/(\w+ )?(\d+)(.+)/.exec(this.context.font),a=parseInt(s),{width:h}=this.measureText(t),c=n>h?a:n/h*a;return this.setTextFont(i+c+o).addText(t,e,r)}addMultilineText(t,e,r,n,i){const s=t.split(" "),o=s.length;let a=s[0];for(let t=1;t<o;t++){const o=`${a} ${s[t]}`;this.measureText(o).width>n?(this.addText(a,e,r),a=`${s[t]} `,r+=i):a=o}return a.length?this.addText(a,e,r):this}stroke(...t){return this.context.stroke(...t),this}addStrokeRect(...t){return this.context.strokeRect(...t),this}addStrokeText(...t){return this.context.strokeText(...t),this}measureText(t,e){if(e){if("function"!=typeof e)throw new TypeError("Callback must be a function.");return e.call(this,this.context.measureText(t),this),this}return this.context.measureText(t)}setTextSize(t){const[,e="",r]=/(\w+ )?(?:\d+)(.+)/.exec(this.context.font);return this.setTextFont(e+t+r)}setStroke(t="#000000"){return this.context.strokeStyle=t,this}setLineWidth(t=1){return this.context.lineWidth=t,this}setStrokeWidth(t){return this.setLineWidth(t)}setLineDashOffset(t){return this.context.lineDashOffset=t,this}setLineJoin(t){return this.context.lineJoin=t,this}setLineCap(t){return this.context.lineCap=t,this}setLineDash(...t){return this.context.setLineDash(...t),this}addImage(t,...e){const r=e.length%2?e.pop():{};if(r.restore&&this.save(),r.type){isNaN(r.radius)&&(r.radius=10);const[t,n,i,s]=e;"round"===r.type?this.createRoundClip(t+r.radius,n+r.radius,r.radius):"bevel"===r.type&&this.createBeveledClip(t,n,i,s,r.radius)}return this._resolveImage(t,t=>this.context.drawImage(t,...e)),r.restore&&this.restore(),this}addRoundImage(t,e,r,n,i,s,o){return"boolean"==typeof s&&([s=Math.min(n,i)/2,o]=[o,s]),void 0===o&&(o=!0),this.addImage(t,e,r,n,i,{type:"round",radius:s,restore:o})}addCircularImage(t,e,r,n,i=!0){i&&this.save();const s=2*n;return this.createRoundClip(e,r,n),this._resolveImage(t,t=>this.context.drawImage(t,e-n,r-n,s,s)),i&&this.restore(),this}addBeveledImage(t,e,r,n,i,s=10,o=!0){return this.addImage(t,e,r,n,i,{type:"bevel",radius:s,restore:o})}addCircle(t,e,r){return this.save().createRoundPath(t,e,r).fill().restore()}addRect(...t){return this.context.fillRect(...t),this}addBeveledRect(...t){return this.save().createBeveledPath(...t).fill().restore()}createRoundPath(t,e,r,n=0,i=2*Math.PI){return this.context.beginPath(),this.context.arc(t,e,r,n,i,!1),this}createRoundClip(...t){return this.createRoundPath(...t).clip()}createRectPath(...t){return this.context.rect(...t),this}createRectClip(...t){return this.createRectPath(...t).clip()}createBeveledPath(t,e,r,n,i=10){if(r>0&&n>0){let s;"number"==typeof i?s={tl:i=Math.min(i,r/2,n/2),tr:i,br:i,bl:i}:(s=i,i=Math.min(5,r/2,n/2));const{tl:o=i,tr:a=i,br:h=i,bl:c=i}=s;this.context.beginPath(),this.context.moveTo(t+o,e),this.context.lineTo(t+r-a,e),this.context.quadraticCurveTo(t+r,e,t+r,e+a),this.context.lineTo(t+r,e+n-h),this.context.quadraticCurveTo(t+r,e+n,t+r-h,e+n),this.context.lineTo(t+c,e+n),this.context.quadraticCurveTo(t,e+n,t,e+n-c),this.context.lineTo(t,e+o),this.context.quadraticCurveTo(t,e,t+o,e),this.context.closePath(),this.context.clip()}return this}createBeveledClip(...t){return this.createBeveledPath(...t).clip()}setColor(t){return this.context.fillStyle=t,this}setTextFont(t){return this.context.font=t,this}setTextAlign(t){return this.context.textAlign=t,this}setTextBaseline(t){return this.context.textBaseline=t,this}beginPath(){return this.context.beginPath(),this}closePath(){return this.context.closePath(),this}createPattern(t,e,r){return this._resolveImage(t,t=>r(this.context.createPattern(t,e))),this}printPattern(t,e){return this.createPattern(t,e,t=>this.setColor(t))}createLinearGradient(t,e,r,n,i=[]){const s=this.context.createLinearGradient(t,e,r,n);for(let t=0;t<i.length;t++)s.addColorStop(i[t].position,i[t].color);return s}printLinearGradient(...t){const e=this.createLinearGradient(...t);return this.setColor(e)}createRadialGradient(t,e,r,n,i,s,o=[]){const a=this.context.createRadialGradient(t,e,r,n,i,s);for(let t=0;t<o.length;t++)a.addColorStop(o[t].position,o[t].color);return a}printRadialGradient(...t){const e=this.createRadialGradient(...t);return this.setColor(e)}createEllipse(t,e,r,n,i=0,s=0,o=2*Math.PI,a){return this.context.ellipse(t,e,r,n,i,s,o,a),this}arc(t,e,r,n=0,i=2*Math.PI,s=!1){return this.context.arc(t,e,r,n,i,s),this}arcTo(...t){return this.context.arcTo(...t),this}quadraticCurveTo(...t){return this.context.quadraticCurveTo(...t),this}bezierCurveTo(...t){return this.context.bezierCurveTo(...t),this}lineTo(...t){return this.context.lineTo(...t),this}moveTo(...t){return this.context.moveTo(...t),this}setShadowBlur(t){return this.context.shadowBlur=t,this}setShadowColor(t){return this.context.shadowColor=t,this}setShadowOffsetX(t){return this.context.shadowOffsetX=t,this}setShadowOffsetY(t){return this.context.shadowOffsetY=t,this}setMiterLimit(t){return this.context.miterLimit=t,this}setPatternQuality(t){return this.context.patternQuality=t,this}setTextDrawingMode(t){return this.context.textDrawingMode=t,this}setAntialiasing(t){return this.context.antialias=t,this}setGlobalCompositeOperation(t){return this.context.globalCompositeOperation=t,this}setGlobalAlpha(t){return this.context.globalAlpha=t,this}resetShadows(){return this.setShadowBlur(0).setShadowColor("#000000")}clearCircle(t,e,r,n=0,i=2*Math.PI){return this.createRoundClip(t,e,r,n,i).clearPixels(t-r,e-r,2*r,2*r)}clearPixels(t=0,e=0,r=this.width,n=this.height){return this.context.clearRect(t,e,r,n),this}getLineDash(){return this.context.getLineDash()}get lineDash(){return this.getLineDash()}isPointInPath(...t){return this.context.isPointInPath(...t)}isPointInStroke(...t){return this.context.isPointInStroke(...t)}process(t,...e){return t.call(this,this,...e),this}addTextFont(t,e){return"function"==typeof this.context.addFont?this.context.addFont(new i.Font(e,t)):Canvas.registerFont(t,e),this}toBuffer(...t){return this.canvas.toBuffer(...t)}toBufferAsync(){return new Promise((t,e)=>this.canvas.toBuffer((r,n)=>{r?e(r):t(n)}))}toDataURL(...t){return this.canvas.toDataURL(...t)}toDataURLAsync(t){return new Promise((e,r)=>this.canvas.toDataURL(t,(t,n)=>{t?r(t):e(n)}))}toBlob(...t){return this.canvas.toBlob(...t)}toBlobAsync(...t){return new Promise(e=>this.canvas.toBlob(e,...t))}_resolveImage(t,e){if(t instanceof i.Image)return e(t),t;const r=new i.Image;return r.onload=e.bind(this,r),r.src=t,r}static fromCanvas(t){const e=new Canvas;e.canvas=t,e.context=t.getContext("2d")}static getCanvas(){return i}static registerFont(t,e){if("function"!=typeof i.registerFont)throw new Error("registerFont is not supported in this version of node-canvas, please install node-canvas 2.x.");if(!e)throw new TypeError("A family must be specified for registerFont.");return i.registerFont(t,e.constructor===Object?e:{family:e}),Canvas}}t.exports=Canvas},function(t,e){},function(t,e){}])});